<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Админ — TurkiyaModa</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <nav class="navbar">
      <h1 class="logo">TurkiyaModa</h1>
      <ul class="nav-links">
        <li><a href="index.html">Главная</a></li>
        <li><a href="catalog.html">Каталог</a></li>
        <li><a href="about.html">О нас</a></li>
        <li><a href="delivery.html">Доставка</a></li>
        <li><a href="#contact">Контакты</a></li>
        <li><a href="admin.html">Админ</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <section>
      <form class="admin-form" id="adminForm">
        <h2>Добавить товар</h2>
        <label for="name">Название</label>
        <input type="text" id="name" required />
        <label for="desc">Описание</label>
        <textarea id="desc" rows="3" required></textarea>
        <label for="price">Цена (сомони)</label>
        <input type="number" id="price" min="0" step="0.01" required />
        <label for="img">Фото товара</label>
        <input type="file" id="img" accept="image/*" required />
        <button type="submit">Добавить товар</button>
      </form>
    </section>
  </main>
  <footer>
    <p>&copy; 2025 TurkiyaModa. Все права защищены.</p>
  </footer>

  <script>
    const form = document.getElementById('adminForm');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const desc = document.getElementById('desc').value.trim();
      const price = parseFloat(document.getElementById('price').value);
      const imgInput = document.getElementById('img');

      if (!name || !desc || isNaN(price) || price < 0 || imgInput.files.length === 0) {
        alert('Пожалуйста, заполните все поля корректно');
        return;
      }

      const file = imgInput.files[0];

      // Конвертируем фото в base64 (dataURL)
      const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
      });

      const imgDataUrl = await toBase64(file);

      // Получаем текущий массив товаров
      let products = JSON.parse(localStorage.getItem('turkiyamoda-products') || '[]');

      // Добавляем новый товар
      products.push({name, desc, price: price.toFixed(2), img: imgDataUrl});

      // Сохраняем обратно в localStorage
      localStorage.setItem('turkiyamoda-products', JSON.stringify(products));

      alert(`Товар "${name}" добавлен!`);

      // Сбрасываем форму
      form.reset();
    });
  </script>
</body>
</html>
